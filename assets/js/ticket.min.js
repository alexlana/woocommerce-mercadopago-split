!function(l){"use strict";l(function(){var e=!1,p="CPF",c={site_id:wc_mercadopago_ticket_params.site_id},o={discount_action_url:wc_mercadopago_ticket_params.discount_action_url,payer_email:wc_mercadopago_ticket_params.payer_email,activated:wc_mercadopago_ticket_params.coupon_mode,status:!1};function t(){return!document.getElementById("payment_method_woo-mercado-pago-ticket").checked||("MLB"===c.site_id?(function(){for(var e=document.querySelector("#mercadopago-form-ticket"),t=e.querySelectorAll("[data-checkout]"),o=e.querySelectorAll(".mp-erro_febraban"),r=0;r<t.length;r++){var c=t[r],n=e.querySelector(o[r].getAttribute("data-main"));"none"===c.parentNode.style.display||-1!==c.value&&""!==c.value?(o[r].style.display="none",n.classList.remove("mp-form-control-error")):(o[r].style.display="inline-block",n.classList.add("mp-form-control-error"))}for(var u=0;u<t.length;u++){var a=t[u];if("none"!==a.parentNode.style.display&&(-1===a.value||""===a.value))return a.focus(),!1}return!0}()&&r()?e=!0:n(),e):"MLU"===c.site_id?(r()?e=!0:n(),e):void 0)}function r(){var e,t=document.getElementById("mp_doc_number"),o=document.getElementById("mp_error_docnumber"),r=!1;return"MLB"===c.site_id&&(e=t.value,r=("CPF"!==p?function(e){if(""===(e=e.replace(/[^\d]+/g,"")))return!1;if(14!==e.length)return!1;if("00000000000000"===e||"11111111111111"===e||"22222222222222"===e||"33333333333333"===e||"44444444444444"===e||"55555555555555"===e||"66666666666666"===e||"77777777777777"===e||"88888888888888"===e||"99999999999999"===e)return!1;for(var t=e.length-2,o=e.substring(0,t),r=e.substring(t),c=0,n=t-7,u=t;1<=u;u--)c+=o.charAt(t-u)*n--,n<2&&(n=9);var a=c%11<2?0:11-c%11;if(a.toString()!==r[0])return!1;for(t+=1,o=e.substring(0,t),c=0,n=t-7,u=t;1<=u;u--)c+=o.charAt(t-u)*n--,n<2&&(n=9);return(a=c%11<2?0:11-c%11).toString()===r[1]}:function(e){var t,o;if(t=0,"00000000000"===(e=e.replace(/[.-\s]/g,"")))return!1;for(var r=1;r<=9;r++)t+=parseInt(e.substring(r-1,r),10)*(11-r);10!=(o=10*t%11)&&11!==o||(o=0);if(o!==parseInt(e.substring(9,10),10))return!1;t=0;for(var c=1;c<=10;c++)t+=parseInt(e.substring(c-1,c),10)*(12-c);10!=(o=10*t%11)&&11!==o||(o=0);return o===parseInt(e.substring(10,11),10)})(e)),"MLU"===c.site_id&&(r=""!==(e=t.value)&&function(e){var t=0,o=0,r=0,c=e[e.length-1];if(e.length<=6)for(o=e.length;o<7;o++)e="0"+e;for(o=0;o<7;o++)t+=parseInt("2987634"[o],10)*parseInt(e[o],10)%10;r=t%10==0?0:10-t%10;return c===r.toString()}(e)),r?(o.style.display="none",t.classList.remove("mp-form-control-error"),r=!0):(o.style.display="block",t.classList.add("mp-form-control-error"),t.focus()),r}function n(){0<l("form#order_review").length&&l(".blockOverlay").css("display","none")}function u(){document.querySelector("#mpCouponApplyedTicket").style.display="none",""===document.querySelector("#couponCodeTicket").value?(o.status=!1,document.querySelector("#mpCouponErrorTicket").style.display="block",document.querySelector("#mpCouponErrorTicket").innerHTML=wc_mercadopago_ticket_params.coupon_empty,document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#discountTicket").value=0):o.status?(o.status=!1,document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#applyCouponTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#couponCodeTicket").value="",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#discountTicket").value=0):(document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.loading+") 98% 50% no-repeat #fff",document.querySelector("#couponCodeTicket").style.border="1px solid #cecece",document.querySelector("#applyCouponTicket").disabled=!0,function(){var e=o.discount_action_url,t="?";0<=e.indexOf("?")&&(t="&");e+=t+"site_id="+wc_mercadopago_ticket_params.site_id,e+="&coupon_id="+document.querySelector("#couponCodeTicket").value,e+="&amount="+document.querySelector("#amountTicket").value,e+="&payer="+o.payer_email,l.ajax({url:e,method:"GET",timeout:5e3,error:function(){o.status=!1,document.querySelector("#mpCouponApplyedTicket").style.display="none",document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#applyCouponTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#couponCodeTicket").value="",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#discountTicket").value=0},success:function(e){200===e.status?(o.status=!0,document.querySelector("#mpCouponApplyedTicket").style.display="block",document.querySelector("#discountTicket").value=e.response.coupon_amount,document.querySelector("#mpCouponApplyedTicket").innerHTML=wc_mercadopago_ticket_params.discount_info1+" <strong>"+a(e.response.currency_id)+" "+Math.round(100*e.response.coupon_amount)/100+"</strong> "+wc_mercadopago_ticket_params.discount_info2+" "+e.response.name+".<br>"+wc_mercadopago_ticket_params.discount_info3+" <strong>"+a(e.response.currency_id)+" "+Math.round(100*document.querySelector("#amountTicket").value)/100+"</strong><br>"+wc_mercadopago_ticket_params.discount_info4+" <strong>"+a(e.response.currency_id)+" "+Math.round(100*(document.getElementById("amountTicket").value-document.getElementById("discountTicket").value))/100+"*</strong><br><i>"+wc_mercadopago_ticket_params.discount_info5+'</i><br><a href="https://api.mercadolibre.com/campaigns/'+e.response.id+'/terms_and_conditions?format_type=html" target="_blank">'+wc_mercadopago_ticket_params.discount_info6+"</a>",document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.check+") 94% 50% no-repeat #fff",document.querySelector("#couponCodeTicket").style.border="1px solid #cecece",document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.remove,document.querySelector("#campaign_idTicket").value=e.response.id,document.querySelector("#campaignTicket").value=e.response.name):(o.status=!1,document.querySelector("#mpCouponApplyedTicket").style.display="none",document.querySelector("#mpCouponErrorTicket").style.display="block",document.querySelector("#mpCouponErrorTicket").innerHTML=e.response.message,document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.error+") 94% 50% no-repeat #fff",document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#discountTicket").value=0),document.querySelector("#applyCouponTicket").disabled=!1}})}())}function a(e){return"ARS"===e?"$":"BRL"===e?"R$":"COP"===e||"CLP"===e||"MXN"===e?"$":"VEF"===e?"Bs":"PEN"===e?"S/":"UYU"===e?"$U":"$"}0<l("form#order_review").length&&"yes"===o.activated&&l("#applyCouponTicket").on("click",u),l("body").on("updated_checkout",function(){"MLB"===c.site_id&&function(){var e=document.getElementById("mp_box_lastname"),t=document.getElementById("mp_box_firstname"),o=document.getElementById("mp_firstname_label"),r=document.getElementById("mp_socialname_label"),c=document.getElementById("mp_cpf_label"),n=document.getElementById("mp_cnpj_label"),u=document.getElementById("mp_doc_number"),a=document.querySelectorAll('input[type=radio][name="mercadopago_ticket[docType]"]');n.style.display="none",r.style.display="none";for(var l=function(){p="CPF"===this.value?(c.style.display="block",e.style.display="grid",o.style.display="block",n.style.display="none",r.style.display="none",t.classList.remove("mp-col-md-8"),t.classList.add("mp-col-md-4"),u.setAttribute("maxlength","14"),u.setAttribute("onkeyup","mpMaskInput(this, mpCpf)"),"CPF"):(c.style.display="none",e.style.display="none",o.style.display="none",n.style.display="block",r.style.display="block",t.classList.remove("mp-col-md-4"),t.classList.add("mp-col-md-8"),u.setAttribute("maxlength","18"),u.setAttribute("onkeyup","mpMaskInput(this, mpCnpj)"),"CNPJ")},i=0;i<a.length;i++)a[i].addEventListener("change",l)}(),"yes"===o.activated&&l("#applyCouponTicket").on("click",u)}),l("form.checkout").on("checkout_place_order_woo-mercado-pago-ticket",t),l("form#order_review").submit(t)})}(jQuery);